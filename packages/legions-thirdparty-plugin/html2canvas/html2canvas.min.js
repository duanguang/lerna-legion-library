/**
 * legions-thirdparty-plugin v0.0.1
 * (c) 2020 duanguang
 * @license MIT
 */
var legionsThirdpartyHtml2canvasPlugin=function(t){"use strict";var n,e,o,i,r=(n=document.createElement("canvas"),o={canvas:!!(e=n.getContext("2d")),imageData:!!e.getImageData,dataURL:!!n.toDataURL,btoa:!!window.btoa},i="image/octet-stream",{saveAsImage:a,saveAsPNG:function(t,n,e){return a(t,n,e,"png")},saveAsJPEG:function(t,n,e){return a(t,n,e,"jpeg")},saveAsGIF:function(t,n,e){return a(t,n,e,"gif")},saveAsBMP:function(t,n,e){return a(t,n,e,"bmp")},convertToImage:l,convertToPNG:function(t,n,e){return l(t,n,e,"png")},convertToJPEG:function(t,n,e){return l(t,n,e,"jpeg")},convertToGIF:function(t,n,e){return l(t,n,e,"gif")},convertToBMP:function(t,n,e){return l(t,n,e,"bmp")}});function u(t,n,e){var r=t.width,a=t.height;null==n&&(n=r),null==e&&(e=a);var o=document.createElement("canvas"),i=o.getContext("2d");return o.width=n,o.height=e,i.drawImage(t,0,0,r,a,0,0,n,e),o}function c(t,n,e,r){return(t=u(t,e,r)).toDataURL(n)}function g(t){document.location.href=t}function f(t){var n=document.createElement("img");return n.src=t,n}function m(t){return"image/"+(t=t.toLowerCase().replace(/jpg/i,"jpeg")).match(/png|jpeg|bmp|gif/)[0]}function b(t){if(!window.btoa)throw"btoa undefined";var n="";if("string"==typeof t)n=t;else for(var e=0;e<t.length;e++)n+=String.fromCharCode(t[e]);return btoa(n)}function v(t){var n=t.width,e=t.height;return t.getContext("2d").getImageData(0,0,n,e)}function d(t,n){return"data:"+n+";base64,"+t}function s(t){var n=t.width,e=t.height,r=n*e*3,a=54+r,o=[66,77,255&a,a>>8&255,a>>16&255,a>>24&255,0,0,0,0,54,0,0,0],i=[40,0,0,0,255&n,n>>8&255,n>>16&255,n>>24&255,255&e,e>>8&255,e>>16&255,e>>24&255,1,0,24,0,0,0,0,0,255&r,r>>8&255,r>>16&255,r>>24&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],u=(4-3*n%4)%4,c=t.data,g="",f=n<<2,m=e,v=String.fromCharCode;do{for(var d=f*(m-1),s="",l=0;l<n;l++){var p=l<<2;s+=v(c[d+p+2])+v(c[d+p+1])+v(c[d+p])}for(var h=0;h<u;h++)s+=String.fromCharCode(0);g+=s}while(--m);return b(o.concat(i))+b(g)}function a(t,n,e,r){var a;o.canvas&&o.dataURL&&("string"==typeof t&&(t=document.getElementById(t)),null==r&&(r="png"),r=m(r),/bmp/.test(r)?(a=v(u(t,n,e)),g(d(s(a),i))):g(c(t,r,n,e).replace(r,i)))}function l(t,n,e,r){if(o.canvas&&o.dataURL){if("string"==typeof t&&(t=document.getElementById(t)),null==r&&(r="png"),r=m(r),/bmp/.test(r)){var a=v(u(t,n,e));return f(d(s(a),"image/bmp"))}return f(c(t,r,n,e))}}return t.Canvas2Image=r,t}({});